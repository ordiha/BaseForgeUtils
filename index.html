<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BaseForgeUtils - WalletConnect</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      margin: 0;
      padding: 20px;
      color: #fff;
    }
    .container {
      background: rgba(255, 255, 255, 0.95);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      max-width: 800px;
      width: 100%;
      color: #333;
    }
    .btn {
      padding: 12px 24px;
      font-size: 16px;
      cursor: pointer;
      background: linear-gradient(45deg, #ff6b6b, #ff8e53);
      border: none;
      border-radius: 8px;
      color: white;
      margin: 10px;
      transition: transform 0.2s;
    }
    .btn:hover { transform: scale(1.05); background: linear-gradient(45deg, #e55a5a, #e57b45); }
    input, select {
      padding: 12px;
      font-size: 14px;
      margin: 8px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 100%;
      box-sizing: border-box;
      background: #f9f9f9;
    }
    .addr, .chain { font-size: 14px; margin: 8px 0; color: #555; }
    .card {
      margin: 15px 0;
      padding: 15px;
      border-radius: 10px;
      background: linear-gradient(135deg, #e0eafc, #cfdef3);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .status { font-size: 14px; color: #333; word-wrap: break-word; }
    h1 { font-size: 28px; margin: 0 0 10px; color: #fff; text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); }
    h2 { font-size: 18px; margin: 10px 0 5px; color: #333; }
    .lead { font-size: 16px; color: #666; margin-bottom: 20px; }
    .foot { margin-top: 20px; text-align: center; color: #ccc; }
    .connect-row { display: flex; flex-wrap: wrap; align-items: center; gap: 10px; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
  <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
</head>
<body>
  <div class="container">
    <header class="top">
      <h1>ðŸ›  BaseForgeUtils</h1>
      <p class="lead">Connect via WalletConnect or MetaMask to interact with 38 utility contracts on Base Mainnet.</p>
      <div class="connect-row">
        <button id="btnConnect" class="btn">ðŸ”— Connect Wallet</button>
        <div id="addr" class="addr">Not connected</div>
        <div id="chain" class="chain"></div>
      </div>
    </header>
    <main class="grid" id="cards">
      <!-- Contract cards injected dynamically -->
    </main>
    <footer class="foot">
      <div>Repo: <code>BaseForgeUtils</code></div>
      <div id="txLog" class="txlog"></div>
    </footer>
  </div>
  <script>
    let web3;
    let accounts;
    let provider;

    const contracts = [
      { name: "EventEmitter", address: "0x0CFd7ed0e6CdaBB0472326665B21266cC76F4a5B", method: "emitEvent", type: "string", inputId: "eventMessage" },
      { name: "ValueSetter", address: "0xfef9945e5f88B4B915Bd55B293f7C6D1EB41DdCF", method: "setValue", type: "number", inputId: "valueInput" },
      { name: "TimestampChecker", address: "0x97D0F9D326a6F8e2Fcf1D3731b3F108d8Ea4545e", method: "checkTimestamp", type: "none", inputId: "" },
      { name: "BalanceTracker", address: "0x88289d4cB0A6CE69Ac137559245ad4C54AFe9c4a", method: "updateBalance", type: "number", inputId: "balanceInput" },
      { name: "MessageEncoder", address: "0xaAb250E1199F1B4A2a6b5ba3E30c2752676Dd52c", method: "encodeMessage", type: "string", inputId: "messageInput" },
      { name: "RandomSeedGen", address: "0x441368286792D14043deEd03Cb047f66d29effd0", method: "generateSeed", type: "number", inputId: "seedInput" },
      { name: "TaskScheduler", address: "0xfD817bF7a3a985684B5c56F34583d927954c530a", method: "scheduleTask", type: "number", inputId: "taskTime" },
      { name: "ScoreLedger", address: "0xf99CEA5F22cE40B51c794d452E4cEacF49E32503", method: "recordScore", type: "number", inputId: "scoreInput" },
      { name: "FeedbackVault", address: "0xD60A2523EBcf7A4cba6D8Fee7c57f75983a510b9", method: "submitFeedback", type: "string", inputId: "feedbackInput" },
      { name: "WishRegistry", address: "0xC4A9C6996043A5f4407a3DDD0B85159252fD328b", method: "registerWish", type: "string", inputId: "wishInput" },
      { name: "QuizEngine", address: "0x6263067390bEDeBb38b5B534270C1489c0d004bf", method: "answerQuestion", type: "bool", inputId: "answerInput" },
      { name: "DonationVault", address: "0x022E5418d4C9151F69e4a0E0a1bf06BCc5B58e0C", method: "makeDonation", type: "eth", inputId: "donationAmount" },
      { name: "BadgeIssuer", address: "0x3eE6F8C8F0535B22b4cdcF1785C0342084764AEf", method: "issueBadge", type: "string", inputId: "badgeInput" },
      { name: "PollAggregator", address: "0xa352bB1f646CCe12564696628E16de617955a893", method: "updatePollResult", type: "number", inputId: "pollResult" },
      { name: "ReminderTrigger", address: "0xDd6DA2D4172e3aC6Abb918827CB8f114731847F9", method: "triggerReminder", type: "number", inputId: "reminderTime" },
      { name: "FeedbackAggregator", address: "0xc683a1153d27d89588A167EfD7963426D0819198", method: "aggregateFeedback", type: "none", inputId: "" },
      { name: "PollViewer", address: "0x3494e15B6a9e97c00FFf34C40894536a65c7986c", method: "viewPoll", type: "number", inputId: "pollId" },
      { name: "EventLogger", address: "0x53aD19AC899C652f4E0400023101Fb66625c5900", method: "logEvent", type: "bytes32", inputId: "eventHash" },
      { name: "PriceUpdater", address: "0x4b830492A7E1F4163BE2772BbE960eEC13b1D3cc", method: "updatePrice", type: "number", inputId: "priceInput" },
      { name: "TodoManager", address: "0x669D72D5e4BCbec9d7595F08295cc532Dc648CFB", method: "addTodo", type: "string", inputId: "todoInput" },
      { name: "ScoreUpdater", address: "0xa370D1B816Ec480F2B854c1a8661E5f5D4bD3ee9", method: "updateScore", type: "number", inputId: "scoreUpdate" },
      { name: "FeedbackReceiver", address: "0xB3d6EC7Ac1B5D79385217b08AA720095BFA637ea", method: "receiveFeedback", type: "none", inputId: "" },
      { name: "WishUpdater", address: "0x2528FD3604611aeDAf7dCff8c62C49D5aC2c0f5a", method: "updateWish", type: "string", inputId: "wishUpdate" },
      { name: "QuizSolver", address: "0x0b8E2bAf22fF479599060d6B24c83e3ee8E0F04C", method: "setSolution", type: "number", inputId: "solutionInput" },
      { name: "DonationReceiver", address: "0xCddD880bF2Cfe4C2cB56E1030E2541B4AC1E7b86", method: "receiveDonation", type: "eth", inputId: "donationReceive" },
      { name: "BadgeViewer", address: "0xE9f9e065033266f8b334Fe023bBC2217fC29C369", method: "viewBadge", type: "none", inputId: "" },
      { name: "PollUpdater", address: "0x898e9CCfA8863c5CFa55C07C52C4d5F7a44004e5", method: "updatePoll", type: "number", inputId: "pollUpdate" },
      { name: "ReminderViewer", address: "0xd2FC2Fc2c42787f66541F8c0f6cB3F892Ee99f36", method: "viewReminder", type: "string", inputId: "reminderInput" },
      { name: "FeedbackViewer", address: "0x911B78249De58C3CFAa687D366d7C36b24971d68", method: "viewFeedback", type: "string", inputId: "feedbackView" },
      { name: "PollLogger", address: "0xA9A2d8A534359D313552AEc3Fd731a5Bc0F19efF", method: "logPoll", type: "bytes32", inputId: "pollLog" },
      { name: "EventUpdater", address: "<ADDRESS>", method: "updateEvent", type: "number", inputId: "eventUpdate" },
      { name: "PriceLogger", address: "0xbaaF48116004E506bE09513E693db126d0306aeA", method: "logPrice", type: "number", inputId: "priceLog" },
      { name: "TodoViewer", address: "<ADDRESS>", method: "viewTodo", type: "none", inputId: "" },
      { name: "ScoreViewer", address: "0x874e8A873A1BA7A554bC272663d97dCEF68a98b5", method: "viewScore", type: "none", inputId: "" },
      { name: "FeedbackSetter", address: "0xF761598f5d992029E87965286E0AD083e9Bb7729", method: "setFeedback", type: "string", inputId: "feedbackSet" },
      { name: "WishLogger", address: "0x0C9273cC350b50b327768cB37CC04B45Fc20c409", method: "logWish", type: "bytes32", inputId: "wishLog" },
      { name: "QuizLogger", address: "0x6B68995C4Fd8D665e1b9dD177c4667E5D3790679", method: "logQuiz", type: "number", inputId: "quizLog" },
      { name: "DonationSetter", address: "0x571a52aae411Ba76ed0A09D35500dd5c713b4eE2", method: "setDonation", type: "number", inputId: "donationSet" },
      { name: "BadgeSetter", address: "0x3672cF3daa3D894A089fbd07233F3f2F737eD2A3", method: "setBadge", type: "string", inputId: "badgeSet" }
    ];

    const cardsContainer = document.getElementById("cards");
    contracts.forEach(c => {
      const card = document.createElement("section");
      card.className = "card";
      card.innerHTML = `
        <h2>ðŸ›  ${c.name} - ${c.method}</h2>
        ${c.type !== "none" ? `<input id="${c.inputId}" placeholder="${c.type === 'eth' ? 'ETH amount' : c.type === 'string' ? 'Enter text' : c.type === 'number' ? 'Enter number' : c.type === 'bytes32' ? 'Enter hash' : 'True/False'}" ${c.type === 'bool' ? 'type="checkbox"' : ''}/>` : ""}
        <button id="btn_${c.name}_${c.method}" class="btn">Call ${c.method}()</button>
        <div class="status" id="status_${c.name}_${c.method}"></div>
      `;
      cardsContainer.appendChild(card);
    });

    document.getElementById("btnConnect").addEventListener("click", async () => {
      try {
        if (window.ethereum) {
          provider = window.ethereum;
          await provider.request({ method: "eth_requestAccounts" });
          web3 = new Web3(provider);
          accounts = await web3.eth.getAccounts();
          showWallet(accounts[0]);
          return;
        }
        const WalletConnectProvider = window.WalletConnectProvider.default;
        provider = new WalletConnectProvider({
          infuraId: "5056a2b581e5962f9e3083d68053b5d8",
          rpc: { 8453: "https://mainnet.base.org" },
          chainId: 8453
        });
        await provider.enable();
        web3 = new Web3(provider);
        accounts = await web3.eth.getAccounts();
        showWallet(accounts[0]);
      } catch (err) {
        console.error(err);
        document.getElementById("txLog").innerText = `Failed to connect: ${err.message}`;
      }
    });

    function showWallet(addr) {
      document.getElementById("addr").innerText = addr;
      document.getElementById("chain").innerText = "Connected to Base Mainnet";
    }

    contracts.forEach(c => {
      document.getElementById(`btn_${c.name}_${c.method}`).addEventListener("click", async () => {
        try {
          const input = c.type !== "none" ? document.getElementById(c.inputId).value : null;
          const abi = [{
            "inputs": c.type === "none" ? [] : [{
              internalType: c.type === "string" ? "string" : c.type === "number" ? "uint256" : c.type === "eth" ? "uint256" : c.type === "bytes32" ? "bytes32" : "bool",
              name: "_param",
              type: c.type === "string" ? "string" : c.type === "number" ? "uint256" : c.type === "eth" ? "uint256" : c.type === "bytes32" ? "bytes32" : "bool"
            }],
            "name": c.method,
            "outputs": [],
            "stateMutability": c.type === "eth" ? "payable" : "nonpayable",
            "type": "function"
          }];
          const contract = new web3.eth.Contract(abi, c.address);
          let tx;
          if (c.type === "eth") {
            tx = await contract.methods[c.method]().send({ from: accounts[0], value: web3.utils.toWei(input, "ether") });
          } else if (c.type === "none") {
            tx = await contract.methods[c.method]().send({ from: accounts[0] });
          } else if (c.type === "string" || c.type === "number" || c.type === "bytes32") {
            tx = await contract.methods[c.method](input).send({ from: accounts[0] });
          } else if (c.type === "bool") {
            tx = await contract.methods[c.method](input === "true" || input === "on").send({ from: accounts[0] });
          }
          document.getElementById(`status_${c.name}_${c.method}`).innerText = `Tx: ${tx.transactionHash}`;
          document.getElementById("txLog").innerText = `Tx sent: ${tx.transactionHash}`;
        } catch (e) {
          console.error(e);
          document.getElementById(`status_${c.name}_${c.method}`).innerText = `Error: ${e.message}`;
          document.getElementById("txLog").innerText = `Error: ${e.message}`;
        }
      });
    });
  </script>
</body>
</html>
